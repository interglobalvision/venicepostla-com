{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","$","window","resize","onResize","document","ready","HomeAnimation","length","getAndSetMaxImageSize","fixWidows","each","string","html","replace","shuffleArray","array","i","j","Math","floor","random","temp","active","paused","nextImage","numberOfFirstLoadImages","requestDelay","animationSpeed","minImages","preloadedImages","$animation","images","WP","animationImages","headerLogoTop","headerNavLeft","requestFirstImages","bindPauses","off","on","mouseover","mouseout","touchstart","touchend","addImage","loadNextImage","imageIndex","srcset","generateSrcset","append","bind","addClass","setMaxImageSize","first","animate","setTimeout","animationInterval","setInterval","$active","index","$next","eq","removeClass","padding","parseInt","css","logoHeight","offset","top","height","navWidth","left","width","imageMaxHeight","imageMaxWidth","max-height","max-width","image","property","hasOwnProperty","substr"],"mappings":"AAGAA,MACEC,gBAAiB,IACjBC,KAAM,WACJ,GAAIC,OAAQC,IAEZC,GAAEC,QAAQC,OAAO,WACfJ,MAAMK,aAGRH,EAAEI,UAAUC,MAAM,cAIlBP,MAAMQ,cAAcT,QAGtBM,SAAU,WACR,GAAIL,OAAQC,IAERC,GAAE,oBAAoBO,QACxBT,MAAMQ,cAAcE,yBAIxBC,UAAW,WAETT,EAAE,kBAAkBU,KAAK,WACvB,GAAIC,QAASX,EAAED,MAAMa,MACrBD,QAASA,OAAOE,QAAQ,YAAY,YACpCb,EAAED,MAAMa,KAAKD,WAIjBG,aAAc,SAASC,OACrB,IAAK,GAAIC,GAAID,MAAMR,OAAS,EAAGS,EAAI,EAAGA,IAAK,CACzC,GAAIC,GAAIC,KAAKC,MAAMD,KAAKE,UAAYJ,EAAI,IACpCK,KAAON,MAAMC,EAEjBD,OAAMC,GAAKD,MAAME,GACjBF,MAAME,GAAKI,QAKjB1B,KAAKW,eACHgB,QAAQ,EACRC,QAAQ,EACRC,UAAW,EACXC,wBAAyB,EACzBC,aAAc,IACdC,eAAgB,IAChBC,UAAW,EACXC,gBAAiB,EACjBhC,KAAM,WACJ,GAAIC,OAAQC,IAEZD,OAAMgC,WAAa9B,EAAE,mBACrBF,MAAMiC,OAASC,GAAGC,gBAClBnC,MAAMoC,cAAgBlC,EAAE,uBACxBF,MAAMqC,cAAgBnC,EAAE,qBAEpBF,MAAMiC,OAAOxB,OAAS,IAExBZ,KAAKmB,aAAahB,MAAMiC,QAGxBjC,MAAMsC,qBAGNtC,MAAMU,0BAKV6B,WAAY,WACV,GAAIvC,OAAQC,IAEZC,GAAE,oBAAoBsC,MAAMC,IAC1BC,UAAa,WACX1C,MAAMyB,QAAS,GAEjBkB,SAAY,WACV3C,MAAMyB,QAAS,GAEjBmB,WAAc,WACZ5C,MAAMyB,QAAS,GAEjBoB,SAAY,WACV7C,MAAMyB,QAAS,MAKrBa,mBAAoB,WAIlB,IAAK,GAHDtC,OAAQC,KAGHiB,EAAI,EAAGA,EAAIlB,MAAM2B,wBAAyBT,IACjDlB,MAAM8C,SAAS5B,IAInB6B,cAAe,WACb,GAAI/C,OAAQC,IAGRD,OAAMiC,OAAOjC,MAAM0B,YACrB1B,MAAM8C,SAAS9C,MAAM0B,YAIzBoB,SAAU,SAASE,YACjB,GAAIhD,OAAQC,KACRgD,OAASjD,MAAMkD,eAAelD,MAAMiC,OAAOe,YAG/ChD,OAAMgC,WAAWmB,OAAO,aAAenD,MAAMiC,OAAOe,YAAY,KAAU,aAAeC,OAAS,yBAA2BD,WAAa,gCAG1I9C,EAAE,oBAAsB8C,YAAYI,KAAK,OAAQ,WAE/ClD,EAAED,MAAMoD,SAAS,0BAEjBrD,MAAMsD,kBAENtD,MAAMuC,aAENvC,MAAM+B,mBAGD/B,MAAMwB,QAAUxB,MAAM+B,iBAAmB/B,MAAM8B,YAGlD5B,EAAE,2BAA2BqD,QAAQF,SAAS,UAE9CrD,MAAMuC,aAENvC,MAAMwD,WAIRrD,OAAOsD,WAAW,WAChBzD,MAAM+C,iBACL/C,MAAM4B,gBAIX5B,MAAM0B,aAGR8B,QAAS,WACP,GAAIxD,OAAQC,IAGZD,OAAMwB,QAAS,EAEfxB,MAAM0D,kBAAoBC,YAAY,WACpC,IAAK3D,MAAMyB,OAAQ,CACjB,GAAImC,SAAU1D,EAAE,kCACZ2D,MAAQD,QAAQC,MAAM,2BACtBC,MAAQ5D,EAAE,2BAA2B6D,GAAGF,MAAQ,EAGpDD,SAAQI,YAAY,UAEhBF,MAAMrD,OAERqD,MAAMT,SAAS,UAGfnD,EAAE,2BAA2BqD,QAAQF,SAAS,YAGjDrD,MAAM6B,iBAIXnB,sBAAuB,WACrB,GAAIV,OAAQC,KAKRgE,QAAUC,SAASlE,MAAMoC,cAAc+B,IAAI,gBAG3CC,WAA2F,GAA7EpE,MAAMoC,cAAciC,SAASC,IAAMtE,MAAMoC,cAAcmC,SAAWN,SAChFO,SAAyF,GAA7ExE,MAAMqC,cAAcgC,SAASI,KAAOzE,MAAMqC,cAAcqC,QAAUT,QAElFjE,OAAM2E,eAAiBzE,EAAEC,QAAQoE,SAAWH,WAC5CpE,MAAM4E,cAAgB1E,EAAEC,QAAQuE,QAAUF,SAE1CxE,MAAMsD,mBAGRA,gBAAiB,WACf,GAAItD,OAAQC,IAGZC,GAAE,oBAAoBiE,KACpBU,aAAc7E,MAAM2E,eAAiB,KACrCG,YAAa9E,MAAM4E,cAAgB,QAIvC1B,eAAgB,SAAS6B,OACvB,GACI9B,QAAS,EAGb,KAAK,GAAI+B,YAAYD,OACfA,MAAME,eAAeD,YACvB/B,QAAU8B,MAAMC,UAAY,IAAMA,SAAW,MAOjD,OAFA/B,QAASA,OAAOiC,OAAO,EAAGjC,OAAOxC,OAAO,KAM5CZ,KAAKE","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, WP */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n\n    });\n\n    _this.HomeAnimation.init();\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    if ($('.animation-image').length) {\n      _this.HomeAnimation.getAndSetMaxImageSize();\n    }\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  shuffleArray: function(array) {\n    for (var i = array.length - 1; i > 0; i--) {\n      var j = Math.floor(Math.random() * (i + 1));\n      var temp = array[i];\n\n      array[i] = array[j];\n      array[j] = temp;\n    }\n  }\n};\n\nSite.HomeAnimation = {\n  active: false,\n  paused: false,\n  nextImage: 0,\n  numberOfFirstLoadImages: 6,\n  requestDelay: 250,\n  animationSpeed: 250,\n  minImages: 3,\n  preloadedImages: 0,\n  init: function() {\n    var _this = this;\n\n    _this.$animation = $('#home-animation');\n    _this.images = WP.animationImages;\n    _this.headerLogoTop = $('#header-item-venice');\n    _this.headerNavLeft = $('#header-item-left');\n\n    if (_this.images.length > 0) {\n      // shuffle randomize array of images from enqueue\n      Site.shuffleArray(_this.images);\n\n      // trigger request of first images\n      _this.requestFirstImages();\n\n      // get & set image max height & width\n      _this.getAndSetMaxImageSize();\n\n    }\n  },\n\n  bindPauses: function() {\n    var _this = this;\n\n    $('.animation-image').off().on({\n      'mouseover': function() {\n        _this.paused = true;\n      },\n      'mouseout': function() {\n        _this.paused = false;\n      },\n      'touchstart': function() {\n        _this.paused = true;\n      },\n      'touchend': function() {\n        _this.paused = false;\n      }\n    });\n  },\n\n  requestFirstImages: function() {\n    var _this = this;\n\n    // get the first x images in the array\n    for (var i = 0; i < _this.numberOfFirstLoadImages; i++) {\n      _this.addImage(i);\n    }\n  },\n\n  loadNextImage: function() {\n    var _this = this;\n\n    // if there is an image at the nextImage index\n    if (_this.images[_this.nextImage]) {\n      _this.addImage(_this.nextImage);\n    }\n  },\n\n  addImage: function(imageIndex) {\n    var _this = this;\n    var srcset = _this.generateSrcset(_this.images[imageIndex]);\n\n    // append img tag for image\n    _this.$animation.append('<img src=\"' + _this.images[imageIndex]['1000'] + '\" srcset=\"' + srcset + '\" id=\"animation-image-' + imageIndex + '\" class=\"animation-image\" />');\n\n    // bind to load event of inserted image\n    $('#animation-image-' + imageIndex).bind('load', function() {\n      // on loaded set loaded class\n      $(this).addClass('animation-image-loaded');\n\n      _this.setMaxImageSize();\n\n      _this.bindPauses();\n\n      _this.preloadedImages++;\n\n      // if animation isn't active trigger animation and more images and the min are loaded\n      if (!_this.active && _this.preloadedImages >= _this.minImages) {\n\n        // set max image size with cached sizes\n        $('.animation-image-loaded').first().addClass('active');\n\n        _this.bindPauses();\n\n        _this.animate();\n      }\n\n      // set timeout to load next image after x delay\n      window.setTimeout(function() {\n        _this.loadNextImage();\n      }, _this.requestDelay);\n    });\n\n    // set next image index to next image\n    _this.nextImage++;\n  },\n\n  animate: function() {\n    var _this = this;\n\n    // set active state true\n    _this.active = true;\n\n    _this.animationInterval = setInterval(function() {\n      if (!_this.paused) {\n        var $active = $('.animation-image-loaded.active');\n        var index = $active.index('.animation-image-loaded')\n        var $next = $('.animation-image-loaded').eq(index + 1);\n\n        // hid current image\n        $active.removeClass('active');\n\n        if ($next.length) {\n          // if next show it\n          $next.addClass('active');\n        } else {\n          // otherwise restart loop\n          $('.animation-image-loaded').first().addClass('active');\n        }\n      }\n    }, _this.animationSpeed);\n\n  },\n\n  getAndSetMaxImageSize: function() {\n    var _this = this;\n\n    // get max height and width for images based on header elems\n\n    // get logo padding-top and convert to integer\n    var padding = parseInt(_this.headerLogoTop.css('padding-top'));\n\n    // offset from viewport, plus dimension, plus padding. x2 for both items\n    var logoHeight = (_this.headerLogoTop.offset().top + _this.headerLogoTop.height() + padding) * 2;\n    var navWidth = (_this.headerNavLeft.offset().left + _this.headerNavLeft.width() + padding) * 2;\n\n    _this.imageMaxHeight = $(window).height() - logoHeight;\n    _this.imageMaxWidth = $(window).width() - navWidth;\n\n    _this.setMaxImageSize();\n  },\n\n  setMaxImageSize: function() {\n    var _this = this;\n\n    // set max height and width for images\n    $('.animation-image').css({\n      'max-height': _this.imageMaxHeight + 'px',\n      'max-width': _this.imageMaxWidth + 'px',\n    });\n  },\n\n  generateSrcset: function(image) {\n    var _this = this;\n    var srcset = '';\n\n    // for each key value pair generate srcset string\n    for (var property in image) {\n      if (image.hasOwnProperty(property)) {\n        srcset += image[property] + ' ' + property + 'w, ';\n      }\n    }\n\n    // trim last 2 characters which will be a comma and a space\n    srcset = srcset.substr(0, srcset.length-2);\n\n    return srcset;\n  }\n};\n\nSite.init();\n"]}